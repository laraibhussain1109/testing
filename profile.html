{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>My Profile - MarvelCollabs</title>
  <!-- Vendor CSS Files -->
  <link href="{% static 'assets/vendor/aos/aos.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/boxicons/css/boxicons.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/glightbox/css/glightbox.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/swiper/swiper-bundle.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/css/style.css' %}" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>

<body background="{% static 'assets/img/hero-bg.jpg' %}">
  <header id="header" class="fixed-top ">
    <div class="container d-flex align-items-center justify-content-lg-between">
      <h1 class="logo me-auto me-lg-0"><a href="/">Marvel<span>Collabs</span></a></h1>
    </div>
  </header>

  <section id="profile" class="d-flex align-items-center justify-content-center" style="min-height: 100vh;">
    <div class="container" data-aos="fade-up">
      {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        <strong>Message:</strong> {{ message }}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      {% endfor %}

      <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
          <div class="card shadow p-4" data-aos="fade-in">
            <div class="d-flex justify-content-between align-items-start mb-3">
              <div>
                <h4 class="mb-0">{{ request.user.get_full_name|default:request.user.username }}</h4>
                <small class="text-muted">@{{ request.user.username }}</small>
              </div>
              <div class="text-right">
                <a href="{% url 'edit_profile' %}" class="btn btn-outline-primary btn-sm mb-1">Edit Profile</a>
                <a href="/accounts/instagram/login/" class="btn btn-outline-secondary btn-sm mb-1">Manage Social</a>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <h6>Contact</h6>
                <p class="mb-1"><strong>Email:</strong> {{ request.user.email }}</p>
                <p class="mb-1"><strong>Phone:</strong> {{ profile.phone|default:"—" }}</p>
                <p class="mb-1"><strong>UPI:</strong> {{ profile.upi_id|default:"—" }}</p>
                <p class="mb-1"><strong>Address:</strong> {% if profile.address %}{{ profile.address|linebreaksbr }}{% else %}—{% endif %}</p>
              </div>

              <div class="col-md-6">
                <h6>Creator info</h6>
                <p class="mb-1"><strong>Creator type:</strong> {{ profile.creator_type|default:"—" }}</p>
                <p class="mb-1"><strong>Top platform:</strong> {{ profile.top_platform|default:"—" }}</p>
                <p class="mb-1"><strong>Top followers:</strong> {{ profile.top_followers|default:"—" }}</p>

                <h6 class="mt-3">Bank</h6>
                <p class="mb-1"><strong>Account:</strong>
                  {% if profile.bank_account_number %}
                    {{ profile.masked_bank_account }}
                  {% else %}
                    —
                  {% endif %}
                </p>
                <p class="mb-1"><strong>IFSC:</strong> {{ profile.bank_ifsc|default:"—" }}</p>
                <p class="mb-1"><strong>Bank:</strong> {{ profile.bank_name|default:"—" }}</p>
                <p class="mb-1"><strong>Account holder:</strong> {{ profile.bank_account_holder_name|default:"—" }}</p>
                {% if profile.bank_verified %}
                  <p class="mt-2"><span class="badge badge-success">Bank Verified</span></p>
                {% endif %}
              </div>
            </div>

            <hr>

            <div>
              <h6>Connected social accounts</h6>
              {% if connected %}
                <div class="d-flex flex-wrap">
                  {% for acc in connected %}
                    <div class="p-2 mr-2 mb-2 border rounded">
                      <strong>{{ acc.provider|capfirst }}</strong><br>
                      <small class="text-muted">{{ acc.extra_data.username|default:acc.uid }}</small>
                    </div>
                  {% endfor %}
                </div>
              {% else %}
                <p class="text-muted">No social accounts connected. <a href="{% url 'connect_social' %}">Connect now</a></p>
              {% endif %}
            </div>

            <hr>

            <div>
              <h6>Metrics & classification</h6>
              {% if metrics %}
                <div class="row">
                  <div class="col-md-6">
                    <p class="mb-1"><strong>Raw metrics:</strong></p>
                    <ul class="pl-3">
                      {% for key, val in metrics.items %}
                        <li>{{ key|capfirst }}: {{ val }}</li>
                      {% endfor %}
                    </ul>
                  </div>
                  <div class="col-md-6">
                    <p class="mb-1"><strong>Category:</strong> {{ category|default:"—" }}</p>
                    <p class="mb-1"><strong>Top platform:</strong> {{ top_platform|default:"—" }}</p>
                    <p class="mb-1"><strong>Top follower count:</strong> {{ top_count|default:"—" }}</p>
                  </div>
                </div>
              {% else %}
                <p class="text-muted">No metrics available yet.</p>
              {% endif %}
            </div>

          </div>
        </div>
      </div>
    </div>
  </section>

  <script src="{% static 'assets/vendor/aos/aos.js' %}"></script>
  <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'assets/vendor/glightbox/js/glightbox.min.js' %}"></script>
  <script src="{% static 'assets/vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>
  <script src="{% static 'assets/vendor/swiper/swiper-bundle.min.js' %}"></script>
  <script src="{% static 'assets/js/main.js' %}"></script>
</body>

</html>
